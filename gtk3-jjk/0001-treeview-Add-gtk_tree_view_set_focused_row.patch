From 41df3a00b2ce2a7962bc9c072f30ab51277629e4 Mon Sep 17 00:00:00 2001
From: jjacky <i.am.jack.mail@gmail.com>
Date: Sun, 5 May 2013 13:03:35 +0200
Subject: [PATCH] treeview: Add gtk_tree_view_set_focused_row()

Allows to set the cursor/focused row, but without any (other/visual) changes
done on tree, specifically no change in the selection, nor any scrolling.

Signed-off-by: jjacky <i.am.jack.mail@gmail.com>
---
 gtk/gtk.symbols   |  1 +
 gtk/gtktreeview.c | 32 ++++++++++++++++++++++++++++++++
 gtk/gtktreeview.h |  2 ++
 3 files changed, 35 insertions(+)

diff --git a/gtk/gtk.symbols b/gtk/gtk.symbols
index 030a06c..5dfa059 100644
--- a/gtk/gtk.symbols
+++ b/gtk/gtk.symbols
@@ -3591,6 +3591,7 @@ gtk_tree_view_set_activate_on_single_click
 gtk_tree_view_set_column_drag_function
 gtk_tree_view_set_cursor
 gtk_tree_view_set_cursor_on_cell
+gtk_tree_view_set_focused_row
 gtk_tree_view_set_destroy_count_func
 gtk_tree_view_set_drag_dest_row
 gtk_tree_view_set_enable_search
diff --git a/gtk/gtktreeview.c b/gtk/gtktreeview.c
index ce46b74..b461335 100644
--- a/gtk/gtktreeview.c
+++ b/gtk/gtktreeview.c
@@ -13382,6 +13382,38 @@ gtk_tree_view_set_cursor_on_cell (GtkTreeView       *tree_view,
 }
 
 /**
+ * gtk_tree_view_set_focused_row:
+ * @tree_view: A #GtkTreeView
+ * @path: A #GtkTreePath
+ *
+ * Sets the current keyboard focus to be at @path, i.e. the row becomes the
+ * focused one. This will not select it, affect the selection, nor will it cause
+ * any scrolling.
+ *
+ * This can be useful when you want to change the focused row (which could
+ * affect behavior when e.g. collapsing an ancestor of the focused row) without
+ * causing any (other/visual) change on @tree_view.
+ *
+ * If @path is invalid for @model, the current cursor (if any) will be unset
+ * and the function will return without failing.
+ *
+ * Since: 3.10
+ **/
+void
+gtk_tree_view_set_focused_row (GtkTreeView  *tree_view,
+                               GtkTreePath  *path)
+{
+  g_return_if_fail (GTK_IS_TREE_VIEW (tree_view));
+  g_return_if_fail (path != NULL);
+
+  if (!tree_view->priv->model)
+    return;
+
+  gtk_tree_view_real_set_cursor (tree_view, path, 0);
+  gtk_tree_view_queue_draw_path (tree_view, path, NULL);
+}
+
+/**
  * gtk_tree_view_get_bin_window:
  * @tree_view: A #GtkTreeView
  *
diff --git a/gtk/gtktreeview.h b/gtk/gtktreeview.h
index cdd94f0..be20656 100644
--- a/gtk/gtktreeview.h
+++ b/gtk/gtktreeview.h
@@ -319,6 +319,8 @@ void                   gtk_tree_view_set_cursor_on_cell            (GtkTreeView
 void                   gtk_tree_view_get_cursor                    (GtkTreeView               *tree_view,
 								    GtkTreePath              **path,
 								    GtkTreeViewColumn        **focus_column);
+void                   gtk_tree_view_set_focused_row               (GtkTreeView               *tree_view,
+                                                                    GtkTreePath               *path);
 
 
 /* Layout information */
-- 
1.8.4

