# $Id$
# Maintainer: Jaroslav Lichtblau <dragonlord@aur.archlinux.org>
# Contributor: Geoffroy Carrier <geoffroy@archlinux.org>
# Contributor: JoÃ«l Schaerer <joel.schaerer@laposte.net>
# Contributor: Daniel J Griffiths <ghost1227@archlinux.us>

_pkgname=autojump
pkgname=$_pkgname-jjk
pkgver=20121116
pkgrel=1
pkgdesc="A faster way to navigate your filesystem from the command line"
arch=('any')
url="http://wiki.github.com/joelthelion/autojump"
license=('GPL3')
depends=('bash' 'python')
optdepends=('python2: needed for jumpapplet')
provides=('autojump')
conflicts=('autojump')

_gitroot=https://github.com/jjk-jacky/autojump.git
_gitname=autojump

build() {
  cd "$srcdir"
  msg "Connecting to GIT server...."

  if [[ -d "$_gitname" ]]; then
    cd "$_gitname" && git pull origin fix-install
    msg "The local files are updated."
  else
    git clone -b fix-install "$_gitroot" "$_gitname"
  fi

  msg "GIT checkout done or server timeout"
  msg "Starting build..."

  rm -rf "$srcdir/$_gitname-build"
  git clone "$srcdir/$_gitname" "$srcdir/$_gitname-build"
  cd "$srcdir/$_gitname-build"
}

package() {
  cd "$srcdir/$_gitname-build"
  sed -i "s:/env python:/python3:g" bin/$_pkgname
  ./install.sh --global --destdir "$pkgdir"
}
